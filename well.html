 <!DOCTYPE html>
<html lang="en">
<script src="redirect.js"></script>
	<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DRBW5PQR5D"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DRBW5PQR5D');
</script>
		<title>Well Well Well</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<link type="text/css" rel="stylesheet" href="main.css">
	  <script src="https://unpkg.com/ml5@0.3.1/dist/ml5.min.js"></script>
	  <script src="https://cdnjs.cloudflare.com/ajax/libs/pizzicato/0.6.1/Pizzicato.min.js"></script>
<style>
/* The Modal (background) */
.modal {
  display: none; /* Hidden by default */
  position: fixed; /* Stay in place */
  z-index: 1; /* Sit on top */
  padding-top: 100px; /* Location of the box */
  left: 0;
  top: 0;
  width: 100%; /* Full width */
  height: 100%; /* Full height */
  overflow: auto; /* Enable scroll if needed */
  background-color: rgb(0,0,0); /* Fallback color */
  background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
}

/* Modal Content */
.modal-content {
  background-color: rgba(150,150,150,.8);
  margin: auto;
  padding: 20px;
  border: 3px solid #888;
  width: 60%;
  font-size: xx-large;
  border-radius: 10px;
}

/* Modal Content */
.modal-content-spark {
  background-color: rgba(150,150,150,.8);
  margin: auto;
  padding: 20px;
  border: 3px solid #888;
  width: 40%;
  font-size: xx-large;
  border-radius: 10px;
}

/* Modal Content */
.modal-content-laptop {
  background-color: rgba(150,150,150,.8);
  margin: auto;
  padding: 20px;
  border: 3px solid #888;
  width: 40%;
  font-size: xx-large;
  border-radius: 10px;
}

/* The Close Button */
.close {
  color: #aaaaaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
}
</style>
</head>
<body>

<!-- The Modal -->
<div id="myModal" class="modal">
  <!-- Modal content -->
  <div class="modal-content">
    <h1>Hi!<br><br><center>welcome!</center></h1>
    <p> We're about to get started, but first we need to make sure you have everything you need for this experience. This installation has experiences that use the camera on your phone and on your computer. To make the most of this, I'd recommend you have both devices ready. If you only want to use one or the other though, that is ok - just select whichever case applies  to you below.</p>
    <ul>
    <li><a id="useBoth" title="" href="#" onclick="return false;">use both an app and the laptop camera (recommended)</a></li>
	<li><a id="useLaptop" title="" href="#" onclick="return false;">use just the laptop camera</a></li>
	<li><a id="useInsta" title="" href="#" onclick="return false;">use just an app</a></li>
</ul>
  </div>
</div>



<!-- The Modal -->
<div id="followUpChooseApp" class="modal">
  <!-- Modal content -->
  <div class="modal-content">
  	<h1>Follow up question: </h1>
    <p>Would you rather use instagram or facebook?</p>
    <p>We will show you QR codes that will take you to the effects. These won't post anything on your profile.</p>
    <ul>
    <li><a id="useInstagram" title="" href="#" onclick="return false;">use my phone's Instagram app</a></li>
	<li><a id="useFacebook" title="" href="#" onclick="return false;">use my phone's Facebook app</a></li>
</ul>
  </div>
</div>


<!-- The Modal -->
<div id="myContentModal1" class="modal">
  <!-- Modal content -->
  <div class="modal-content-spark">
<!--     <span class="close">&times;</span>
 -->    <p>well, this dream was a little unclear - something about being a space dragon.<p>
 		<center>
 			<img id="spaceman_qr" src="/codes/spaceman.png" width="300px">
 			<p><i>effect by Brian Ellis</i></p>
	 	<a id="returnToWell1" title="use both" href="#" onclick="return false;">return to the well</a>
	 	</center>

  </div>
</div>

<!-- The Modal -->
<div id="myContentModal2" class="modal">
  <!-- Modal content -->
  <div class="modal-content-spark">
<!--     <span class="close">&times;</span>
 -->    <p>this dream was pretty straight forward, the kind you could bring into reality at a county fair.<p>
 		<center>
 			<img id="unicorn_qr" src="/codes/unicorn.png" width="300px">
 			<p><i>effect by Brian Ellis</i></p>
	 	<a id="returnToWell2" title="use both" href="#" onclick="return false;">return to the well</a>
	 	</center>

  </div>
</div>




<!-- The Modal -->
<div id="myContentModal3" class="modal">
  <!-- Modal content -->
  <div class="modal-content-laptop">
<!--     <span class="close">&times;</span>
 -->    <p>this wish was for movement, for little drops of rain, and for the intimate sounds of trying to get someone's attention.<p>
 	<ul>
 		<li>Make sure you stand back from the camera</li>
 		<li>Make sure the laptop can see your face and hands</li>
 	</ul>
 		<center>
		 	<a title="use both" href="/showcases/expandingCircle.html" target="_blank">go to wish</a>
 			<p><i>effect by Brian Ellis</i></p>
	 	<a id="returnToWell3" title="use both" href="#" onclick="return false;">return to the well</a>
	 	</center>
  </div>
</div>



<!-- The Modal -->
<div id="myContentModal4" class="modal">
  <!-- Modal content -->
  <div class="modal-content-spark">
<!--     <span class="close">&times;</span>
 -->    <p>being alone is hard...<p>
 		<center>
 			<img id="community_qr" src="/codes/community.png" width="300px">
 			<p><i>effect by Brian Ellis</i></p>
	 	<a id="returnToWell4" title="use both" href="#" onclick="return false;">return to the well</a>
	 	</center>
  </div>
</div>



<!-- The Modal -->
<div id="myContentModal5" class="modal">
  <!-- Modal content -->
  <div class="modal-content-spark">
<!--     <span class="close">&times;</span>
 -->    <p>Voice // identity // Becoming something you are not.<p>
 		<center>
 			<img id="vocal_qr" src="/codes/vocal.png" width="300px">
 			<p><i>effect by Brian Ellis</i></p>
	 	<a id="returnToWell5" title="use both" href="#" onclick="return false;">return to the well</a>
	 	</center>

  </div>
</div>

<!-- The Modal -->
<div id="myContentModal6" class="modal">
  <!-- Modal content -->
  <div class="modal-content-laptop">
<!--     <span class="close">&times;</span>
 -->    <p>this wish was is for a nice spring day<p>
 	<ul>
 		<li>You can sit in front of your computer ("like normal")</li>
 		<li>You will use one hand to interact with the wish</li>
 		<li>Start off by holding your fist up to the screne</li>
 	</ul>
 		<center>
		 	<a title="use both" href="/showcases/thehand.html" target="_blank">go to wish</a>
 			<p><i>effect by Brian Ellis</i></p>
	 	<a id="returnToWell6" title="use both" href="#" onclick="return false;">return to the well</a>
	 	</center>
  </div>
</div>






<!-- The Modal -->
<div id="thanksforcoming" class="modal">
  <!-- Modal content -->
  <div class="modal-content">
<!--     <span class="close">&times;</span>
 -->    <p>Thats all folks, thanks for coming and checking this out!<p>
 		<center>
 			<p><i>installation by Brian Ellis</i></p>
 			<p><i>Presented by Density 512</i></p>
	 	<a id="startOver" title="start over" href="#" onclick="return false;">start again?</a>
	 	</center>

  </div>
</div>



		<div id="info" style="display: none">
			Welcome to the Well Well Well
		</div>


<!--   <canvas id="canvas" width="640" height="480"></canvas> 
 -->  <video id="video" width="640" height="480" autoplay style="display: none"></video>

		<!-- This is the 'compute shader' for the water heightmap: -->
		<script id="heightmapFragmentShader" type="x-shader/x-fragment">

			#include <common>

			uniform vec2 mousePos;
			uniform vec2 leftEyePos;
			uniform vec2 rightEyePos;
			uniform vec2 coinPos;
			uniform float mouseSize;
			uniform float viscosityConstant;
			uniform float heightCompensation;

			void main()	{

				vec2 cellSize = 1.0 / resolution.xy;

				vec2 uv = gl_FragCoord.xy * cellSize;

				// heightmapValue.x == height from previous frame
				// heightmapValue.y == height from penultimate frame
				// heightmapValue.z, heightmapValue.w not used
				vec4 heightmapValue = texture2D( heightmap, uv );

				// Get neighbours
				vec4 north = texture2D( heightmap, uv + vec2( 0.0, cellSize.y ) );
				vec4 south = texture2D( heightmap, uv + vec2( 0.0, - cellSize.y ) );
				vec4 east = texture2D( heightmap, uv + vec2( cellSize.x, 0.0 ) );
				vec4 west = texture2D( heightmap, uv + vec2( - cellSize.x, 0.0 ) );

				// https://web.archive.org/web/20080618181901/http://freespace.virgin.net/hugo.elias/graphics/x_water.htm

				float newHeight = ( ( north.x + south.x + east.x + west.x ) * 0.5 - heightmapValue.y ) * viscosityConstant;

				// Mouse influence
				float mousePhase = clamp( length( ( uv - vec2( 0.5 ) ) * BOUNDS - vec2( mousePos.x, - mousePos.y ) ) * PI / mouseSize, 0.0, PI );
				float coinPhase = clamp( length( ( uv - vec2( 0.5 ) ) * BOUNDS - vec2( coinPos.x, - coinPos.y ) ) * PI / mouseSize, 0.0, PI );
				float leftEyePhase = clamp( length( ( uv - vec2( 0.5 ) ) * BOUNDS - vec2( leftEyePos.x, - leftEyePos.y ) ) * PI / mouseSize, 0.0, PI );
				float rightEyePhase = clamp( length( ( uv - vec2( 0.5 ) ) * BOUNDS - vec2( rightEyePos.x, - rightEyePos.y ) ) * PI / mouseSize, 0.0, PI );
				newHeight += (( cos( mousePhase ) + 1.0 ) * 0.28) + (( cos( leftEyePhase ) + 1.0 ) * -0.28) + (( cos( rightEyePhase ) + 1.0 ) * -0.28) + (( cos( coinPhase ) + 1.0 ) * 0.88);

				heightmapValue.y = heightmapValue.x;
				heightmapValue.x = newHeight;

				gl_FragColor = heightmapValue;

			}

		</script>

		<!-- This is just a smoothing 'compute shader' for using manually: -->
		<script id="smoothFragmentShader" type="x-shader/x-fragment">

			uniform sampler2D smoothTexture;

			void main()	{

				vec2 cellSize = 1.0 / resolution.xy;

				vec2 uv = gl_FragCoord.xy * cellSize;

				// Computes the mean of texel and 4 neighbours
				vec4 textureValue = texture2D( smoothTexture, uv );
				textureValue += texture2D( smoothTexture, uv + vec2( 0.0, cellSize.y ) );
				textureValue += texture2D( smoothTexture, uv + vec2( 0.0, - cellSize.y ) );
				textureValue += texture2D( smoothTexture, uv + vec2( cellSize.x, 0.0 ) );
				textureValue += texture2D( smoothTexture, uv + vec2( - cellSize.x, 0.0 ) );

				textureValue /= 5.0;

				gl_FragColor = textureValue;

			}

		</script>

		<!-- This is a 'compute shader' to read the current level and normal of water at a point -->
		<!-- It is used with a variable of size 1x1 -->
		<script id="readWaterLevelFragmentShader" type="x-shader/x-fragment">

			uniform vec2 point1;

			uniform sampler2D levelTexture;

			// Integer to float conversion from https://stackoverflow.com/questions/17981163/webgl-read-pixels-from-floating-point-render-target

			float shift_right( float v, float amt ) {

				v = floor( v ) + 0.5;
				return floor( v / exp2( amt ) );

			}

			float shift_left( float v, float amt ) {

				return floor( v * exp2( amt ) + 0.5 );

			}

			float mask_last( float v, float bits ) {

				return mod( v, shift_left( 1.0, bits ) );

			}

			float extract_bits( float num, float from, float to ) {

				from = floor( from + 0.5 ); to = floor( to + 0.5 );
				return mask_last( shift_right( num, from ), to - from );

			}

			vec4 encode_float( float val ) {
				if ( val == 0.0 ) return vec4( 0, 0, 0, 0 );
				float sign = val > 0.0 ? 0.0 : 1.0;
				val = abs( val );
				float exponent = floor( log2( val ) );
				float biased_exponent = exponent + 127.0;
				float fraction = ( ( val / exp2( exponent ) ) - 1.0 ) * 8388608.0;
				float t = biased_exponent / 2.0;
				float last_bit_of_biased_exponent = fract( t ) * 2.0;
				float remaining_bits_of_biased_exponent = floor( t );
				float byte4 = extract_bits( fraction, 0.0, 8.0 ) / 255.0;
				float byte3 = extract_bits( fraction, 8.0, 16.0 ) / 255.0;
				float byte2 = ( last_bit_of_biased_exponent * 128.0 + extract_bits( fraction, 16.0, 23.0 ) ) / 255.0;
				float byte1 = ( sign * 128.0 + remaining_bits_of_biased_exponent ) / 255.0;
				return vec4( byte4, byte3, byte2, byte1 );
			}

			void main()	{

				vec2 cellSize = 1.0 / resolution.xy;

				float waterLevel = texture2D( levelTexture, point1 ).x;

				vec2 normal = vec2(
					( texture2D( levelTexture, point1 + vec2( - cellSize.x, 0 ) ).x - texture2D( levelTexture, point1 + vec2( cellSize.x, 0 ) ).x ) * WIDTH / BOUNDS,
					( texture2D( levelTexture, point1 + vec2( 0, - cellSize.y ) ).x - texture2D( levelTexture, point1 + vec2( 0, cellSize.y ) ).x ) * WIDTH / BOUNDS );

				if ( gl_FragCoord.x < 1.5 ) {

					gl_FragColor = encode_float( waterLevel );

				} else if ( gl_FragCoord.x < 2.5 ) {

					gl_FragColor = encode_float( normal.x );

				} else if ( gl_FragCoord.x < 3.5 ) {

					gl_FragColor = encode_float( normal.y );

				} else {

					gl_FragColor = encode_float( 0.0 );

				}

			}

		</script>

		<!-- This is the water visualization shader, copied from the THREE.MeshPhongMaterial and modified: -->
		<script id="waterVertexShader" type="x-shader/x-vertex">

			uniform sampler2D heightmap;

			#define PHONG

			varying vec3 vViewPosition;

			#ifndef FLAT_SHADED

				varying vec3 vNormal;

			#endif

			#include <common>
			#include <uv_pars_vertex>
			#include <uv2_pars_vertex>
			#include <displacementmap_pars_vertex>
			#include <envmap_pars_vertex>
			#include <color_pars_vertex>
			#include <morphtarget_pars_vertex>
			#include <skinning_pars_vertex>
			#include <shadowmap_pars_vertex>
			#include <logdepthbuf_pars_vertex>
			#include <clipping_planes_pars_vertex>

			void main() {

				vec2 cellSize = vec2( 1.0 / WIDTH, 1.0 / WIDTH );

				#include <uv_vertex>
				#include <uv2_vertex>
				#include <color_vertex>

				// # include <beginnormal_vertex>
				// Compute normal from heightmap
				vec3 objectNormal = vec3(
					( texture2D( heightmap, uv + vec2( - cellSize.x, 0 ) ).x - texture2D( heightmap, uv + vec2( cellSize.x, 0 ) ).x ) * WIDTH / BOUNDS,
					( texture2D( heightmap, uv + vec2( 0, - cellSize.y ) ).x - texture2D( heightmap, uv + vec2( 0, cellSize.y ) ).x ) * WIDTH / BOUNDS,
					1.0 );
				//<beginnormal_vertex>

				#include <morphnormal_vertex>
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#include <defaultnormal_vertex>

			#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED

				vNormal = normalize( transformedNormal );

			#endif

				//# include <begin_vertex>
				float heightValue = texture2D( heightmap, uv ).x;
				vec3 transformed = vec3( position.x, position.y, heightValue );
				//<begin_vertex>

				#include <morphtarget_vertex>
				#include <skinning_vertex>
				#include <displacementmap_vertex>
				#include <project_vertex>
				#include <logdepthbuf_vertex>
				#include <clipping_planes_vertex>

				vViewPosition = - mvPosition.xyz;

				#include <worldpos_vertex>
				#include <envmap_vertex>
				#include <shadowmap_vertex>

			}

		</script>
	  <script src="/water.js" type="module"></script>
	</body>
</html>
